"use strict";(self.webpackChunkdeterminant_web=self.webpackChunkdeterminant_web||[]).push([[299],{36:(n,e,t)=>{t.d(e,{Zk:()=>s,k6:()=>c});var o=t(420);function c(n){n&&n.remove()}function s(n,e,t="./images/sigma.svg"){const c=new URL(n);var s,a;return function(n,e,t){const c=new o.hp(n,{level:"M",padding:3,image:{source:t,width:"15%",height:"15%",x:"center",y:"center"}});var s;return e.innerHTML=c.toString(),(s=e).addEventListener("click",(()=>s.classList.toggle("big"))),e}((s=c.toString(),a="/",s.charAt(s.length-a.length)===a?s.substr(0,s.length-a.length):s),e,t)}},299:(n,e,t)=>{t.r(e),t.d(e,{default:()=>l});var o=t(684),c=t(969),s=t(36);const a="black";function i(n,e){if(!n)return;const t=n.querySelectorAll("rect[fill='#000']");for(const n of t)n.style.fill=e}function r(n,e,t,o,c){const a=c.createElement("div");a.classList.add("qrcode"),o.appendChild(a),n.searchParams.set("color",t),n.searchParams.set("mode","net"),(0,s.Zk)(n.toString(),a,"./images/sigma.svg"),i(a,t),e[t]=a}function l(n,e,t){const l=(0,c.B)(n.location,t);if(!l)return;const d=(0,o.A)(t),u=(0,c.Y)(n.location,t),f={};{const n=new URL(u),t=e.querySelector(".qrcontainerserver");r(n,f,"blue",t,e),r(n,f,"red",t,e)}d.on("socket_open",(()=>{i(f.blue,"royalblue")})),d.on("server_message",(n=>{"connected"===n.action?i(f[n.from],a):"close"===n.action&&(0,s.k6)(f[n.from])}));try{d.connect(l)}catch(n){}}},684:(n,e,t)=>{t.d(e,{A:()=>r});const o=["blue","red"];function c(n){}let s="";const a={recv:c,open:c,socket_open:c,socket_close:c,close:c};function i(n){for(const e of o)if(n!==e)return e;return""}const r=function(n){const e="server"===n.mode;let t=null,o=!1;function r(n,e){t=n,t.onmessage=function(n){a.recv(n.data)},t.onopen=function(){o=!0,e.send("close",{}),e.close(),a.open()},t.onclose=function(){o=!1},t.onerror=function(){}}return{connect:function(o){const i=n.color,l=function(n,e,t){const o=new WebSocket(n),i=(n,t,c,s)=>{const a={from:e,to:c||"all",action:n,data:t,ignore:s};return o.send(JSON.stringify(a))},r={onmessage:c,send:i,close:()=>{o.close()}};return o.onopen=function(n){a.socket_open(),s=e,t||i("connected",{color:e})},o.onclose=function(n){a.socket_close(n)},o.onmessage=async function(n){if(n.data instanceof Blob){const e=await n.data.text();return r.onmessage(e)}return r.onmessage(n.data)},o.onerror=function(n){},r}(o,i,e),d=new RTCPeerConnection;d.onicecandidate=function(n){n&&l.send("candidate",n.candidate)},d.oniceconnectionstatechange=()=>{"failed"===d.iceConnectionState&&d.restartIce()};let u=!1;const f="red"===i;let g=!1,h=!1;d.onnegotiationneeded=async()=>{try{u=!0,await d.setLocalDescription(),l.send("description",d.localDescription)}catch(n){}finally{u=!1}},d.ondatachannel=n=>{(null==t||f)&&r(n.channel,l)},l.onmessage=async function(n){const t=JSON.parse(n);var o;if(t.from!==s)if(e)a.server_message(t);else if("candidate"===t.action)!function(n,e){e.addIceCandidate(n).catch((n=>{}))}(t.data,d);else if("description"===t.action){const n=t.data,e=!u&&("stable"===d.signalingState||h),o="offer"===n.type&&!e;if(g=!f&&o,g)return;h="answer"===n.type,await d.setRemoteDescription(n),h=!1,"offer"===n.type&&(await d.setLocalDescription(),l.send("description",d.localDescription))}else"connected"===t.action?(o=l,r(d.createDataChannel("gamechannel"),o)):t.action}},sendMessage:function(n){return!!t&&(!!o&&(t.send(n),o))},on:function(n,e){a[n]=e},getOtherColor:i}}},969:(n,e,t)=>{function o(n,e){return function(n,e,t,o){return e||("https:"!==n?"ws://"+t+":"+o.wsPort:void 0)}(n.protocol,e.wh,n.hostname,e)}function c(n,e){return e.sh||window.location.origin+window.location.pathname}t.d(e,{B:()=>o,Y:()=>c})}}]);